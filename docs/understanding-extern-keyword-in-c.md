# 理解 C

中的“extern”关键字

> 原文:[https://www . geesforgeks . org/understanding-extern-keyword-in-c/](https://www.geeksforgeeks.org/understanding-extern-keyword-in-c/)

我相信这篇文章对 C 处女(即初学者)来说会像对精通 C 的人一样有趣和丰富。所以让我首先说 extern 关键字适用于 C 变量(数据对象)和 C 函数。基本上，extern 关键字扩展了 C 变量和 C 函数的可见性。这可能就是它被命名为 extern 的原因。
虽然大多数人可能理解变量或函数的“声明”和“定义”的区别，但为了完整起见，我想澄清一下。

*   **变量或函数的声明**只是声明变量或函数存在于程序中的某个地方，但是没有为它们分配内存。变量或函数的声明起着重要的作用——它告诉程序它的类型是什么。在*函数*声明的情况下，它还告诉程序参数、它们的数据类型、这些参数的顺序以及函数的返回类型。这就是宣言的全部内容。
*   来到**定义**，当我们*定义*一个变量或函数时，除了声明所做的一切，它还为该变量或函数分配内存。因此，我们可以认为定义是声明的超集(或者声明是定义的子集)。

一个变量或函数可以被*声明*任意次，但只能被*定义*一次。(记住一个基本原则，同一变量或函数不能有两个位置)。
现在回到 extern 关键字。首先，让我们考虑在函数中使用 extern。事实证明，当一个函数被声明或定义时，extern 关键字是隐式假定的。当我们写作时。

```cpp
int foo(int arg1, char arg2);

```

编译器将其视为:

```cpp
extern int foo(int arg1, char arg2);

```

由于 extern 关键字将函数的可见性扩展到了整个程序，所以函数可以在整个程序的任何文件中的任何地方使用(调用)，前提是这些文件包含函数的声明。(有了函数的声明，编译器知道函数的定义存在于其他地方，并继续编译文件)。这就是外在和功能。
现在让我们考虑一下 extern 和变量的使用。首先，在没有定义的情况下，您如何将*声明为*变量？你会做这样的事:

```cpp
extern int var;

```

这里，已经声明了一个名为 var 的整数类型变量(它还没有被定义，所以到目前为止还没有为 var 分配内存)。我们可以想做多少次就做多少次。目前为止一切顺利。🙂
现在，你如何定义 var？你会这样做:

```cpp
int var;

```

在这一行中，一个名为 var 的整数类型变量已经被声明**和**定义(记住*定义*是*声明*的超集)。由于这是一个*定义*，var 的内存也被分配。现在惊喜来了。当我们声明/定义一个函数时，我们看到 extern 关键字是隐式存在的。但是变量不是这样。如果是这样，就永远不会为它们分配内存。因此，当我们想要声明变量而不定义它们时，我们需要显式地包含 extern 关键字。此外，由于 extern 关键字扩展了整个程序的可见性，通过将 extern 关键字与变量一起使用，我们可以在程序中的任何地方使用该变量，只要我们包含它的声明，该变量就在某个地方定义。
现在让我们试着用例子来理解外在。
实施例 1:

## c

```cpp
int var;
int main(void)
{
   var = 10;
   return 0;
}
```

这个程序编译成功。var 是全局定义的(并隐式声明)。
例 2:

## c

```cpp
extern int var;
int main(void)
{
  return 0;
}
```

这个程序编译成功。这里只声明 var。请注意，var 从未使用过，因此不会出现问题。
例 3:

## c

```cpp
extern int var;
int main(void)
{
  var = 10;
  return 0;
}
```

这个程序在编译中抛出一个错误(在链接阶段，更多信息[在这里](https://www.geeksforgeeks.org/internal-linkage-external-linkage-c/))，因为 var 是声明的，但是没有在任何地方定义。本质上，var 没有分配任何内存。程序试图将一个根本不存在的变量的值改为 10。
例 4:

## c

```cpp
#include "somefile.h"
extern int var;
int main(void)
{
 var = 10;
 return 0;
}
```

假设 somefile.h 包含 var 的定义，这个程序会编译成功。
实施例 5:

## c

```cpp
extern int var = 0;
int main(void)
{
 var = 10;
 return 0;
}
```

你认为这个项目会成功吗？好了，C 标准又来了一个惊喜。他们这么说..如果只声明了一个变量，并且初始化器也提供了该声明，那么该变量的内存将被分配——换句话说，该变量将被视为已定义。因此，按照 C 标准，这个程序将编译成功并工作。
这是对 C.
中 extern 关键字的初步观察，简而言之，我们可以说:

1.  声明可以做任何次数，但定义只能做一次。
2.  extern 关键字用于扩展变量/函数的可见性。
3.  由于默认情况下函数在整个程序中都是可见的，所以在函数声明或定义中不需要使用 extern。它的使用是隐含的。
4.  当 extern 与变量一起使用时，它只是声明的，而不是定义的。
5.  作为一个例外，当一个外部变量在初始化时被声明，它也被作为变量的定义。